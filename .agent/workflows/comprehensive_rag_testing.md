---
description: AI ì—ì´ì „íŠ¸ ììœ¨ ì‹¤í–‰ì„ ìœ„í•œ RAG ì‹œìŠ¤í…œ í’ˆì§ˆ í…ŒìŠ¤íŠ¸ ë° ê°œì„  ì›Œí¬í”Œë¡œìš°
---

# RAG ìë™ ê°œì„  ì›Œí¬í”Œë¡œìš°

ì´ ì›Œí¬í”Œë¡œìš°ëŠ” AI ì—ì´ì „íŠ¸ê°€ **ììœ¨ì ìœ¼ë¡œ ì‹¤í–‰**í•˜ì—¬ RAG ì‹œìŠ¤í…œì˜ í’ˆì§ˆì„ í…ŒìŠ¤íŠ¸í•˜ê³  ê°œì„ í•©ë‹ˆë‹¤.

> **í•µì‹¬ ëª©í‘œ**: ì‚¬ìš©ì ì¿¼ë¦¬ì˜ **ì˜ë„ë¥¼ ì •í™•íˆ íŒŒì•…**í•˜ì—¬ **ì›í•˜ëŠ” ë‹µë³€ì„ ì œê³µ**

---

## ì„±ê³µ ê¸°ì¤€

| ë©”íŠ¸ë¦­ | ëª©í‘œ |
|--------|------|
| í…ŒìŠ¤íŠ¸ í†µê³¼ìœ¨ | â‰¥ 85% |
| ì¸í…íŠ¸ ì •í™•ë„ | â‰¥ 80% |
| í‚¤ì›Œë“œ ì»¤ë²„ë¦¬ì§€ í‰ê·  | â‰¥ 70% |
| íšŒê·€ ë°œìƒ | 0ê±´ |

---

## Phase 0: ì‚¬ì „ ê²€ì¦

### 0.1 ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸

// turbo
```bash
uv run regulation status
```

ChromaDB ë°ì´í„° ë¡œë“œ ì—¬ë¶€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤. ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë™ê¸°í™” ë¨¼ì € ì‹¤í–‰:
```bash
uv run regulation sync data/output/ê·œì •ì§‘.json
```

### 0.2 ì´ì „ ê²°ê³¼ í™•ì¸

ì´ì „ ì‹¤í–‰ ê²°ê³¼ê°€ ìˆë‹¤ë©´ í™•ì¸í•©ë‹ˆë‹¤:

```bash
cat data/output/improvement_plan.json 2>/dev/null || echo "ì´ì „ ê²°ê³¼ ì—†ìŒ"
```

---

## Phase 1: í‰ê°€ ì‹¤í–‰

### 1.1 ìë™ í‰ê°€ ì‹¤í–‰

// turbo
```bash
uv run python scripts/auto_evaluate.py --run
```

ì´ ëª…ë ¹ì€:
1. `evaluation_dataset.json`ì˜ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰
2. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ ë¶„ì„
3. `improvement_plan.json`ì— ê°œì„  ì œì•ˆ ì €ì¥

### 1.2 ê²°ê³¼ í•´ì„

í‰ê°€ ì¶œë ¥ì—ì„œ ë‹¤ìŒì„ í™•ì¸í•©ë‹ˆë‹¤:
- **í†µê³¼ìœ¨**: ì „ì²´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¤‘ í†µê³¼í•œ ë¹„ìœ¨
- **ì¸í…íŠ¸ ì •í™•ë„**: ì˜ë„ ì¸ì‹ ì •í™•ë„
- **ì‹¤íŒ¨ ì¼€ì´ìŠ¤ ìˆ˜**: ê°œì„ ì´ í•„ìš”í•œ ì¿¼ë¦¬ ìˆ˜

**ëª©í‘œ ë‹¬ì„± ì‹œ â†’ Phase 6ìœ¼ë¡œ ì´ë™**

---

## Phase 2: ì‹¤íŒ¨ ë¶„ì„

### 2.1 ê°œì„  ì œì•ˆ í™•ì¸

```bash
cat data/output/improvement_plan.json | python -m json.tool
```

### 2.2 ì œì•ˆ ìœ í˜• ë¶„ë¥˜

| ìœ í˜• | ì„¤ëª… | ì²˜ë¦¬ ë°©ë²• |
|------|------|----------|
| `intent` | ì¸í…íŠ¸ íŠ¸ë¦¬ê±° ì¶”ê°€ í•„ìš” | Phase 3.1ì—ì„œ ìë™ íŒ¨ì¹˜ |
| `synonym` | ë™ì˜ì–´ ì¶”ê°€ í•„ìš” | Phase 3.1ì—ì„œ ìë™ íŒ¨ì¹˜ |
| `code_pattern` | QueryAnalyzer íŒ¨í„´ ì¶”ê°€ | Phase 3.2ì—ì„œ ì½”ë“œ ìˆ˜ì • |
| `code_weight` | ê°€ì¤‘ì¹˜ ì¡°ì • í•„ìš” | Phase 3.2ì—ì„œ ì½”ë“œ ìˆ˜ì • |
| `code_audience` | ëŒ€ìƒ ê°ì§€ ë¡œì§ ê°œì„  | Phase 3.2ì—ì„œ ì½”ë“œ ìˆ˜ì • |
| `rerank` | Reranker ê²€í†  í•„ìš” | Phase 3.2ì—ì„œ ë¶„ì„ |
| `architecture` | êµ¬ì¡°ì  ê°œì„  í•„ìš” | ìˆ˜ë™ ê²€í†  í•„ìš” â†’ Phase 6ì—ì„œ ë³´ê³  |

---

## Phase 3: ê°œì„  ì ìš©

### 3.1 ë°ì´í„° íŒ¨ì¹˜ (ìë™)

`intent` ë˜ëŠ” `synonym` ìœ í˜•ì˜ ì œì•ˆì´ ìˆëŠ” ê²½ìš°:

#### ì¸í…íŠ¸ ì¶”ê°€
`improvement_plan.json`ì—ì„œ `intent` ìœ í˜• ì œì•ˆì„ í™•ì¸í•˜ê³ , `data/config/intents.json`ì— ìƒˆ íŠ¸ë¦¬ê±°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

ì˜ˆì‹œ íŒ¨ì¹˜:
```json
// intents.json ë‚´ í•´ë‹¹ ì¸í…íŠ¸ì— íŠ¸ë¦¬ê±° ì¶”ê°€
{
  "intent_id": "overseas_conference",
  "triggers": [
    "í•´ì™¸í•™íšŒ", "í•´ì™¸ í•™íšŒ", "êµ­ì œí•™íšŒ"  // ìƒˆ íŠ¸ë¦¬ê±° ì¶”ê°€
  ]
}
```

#### ë™ì˜ì–´ ì¶”ê°€
`synonym` ìœ í˜• ì œì•ˆì„ í™•ì¸í•˜ê³ , `data/config/synonyms.json`ì— ì¶”ê°€í•©ë‹ˆë‹¤.

### 3.2 ì½”ë“œ ê°œì„  (ë°˜ìë™)

`code_*` ìœ í˜• ì œì•ˆì˜ ê²½ìš°, ë‹¤ìŒ íŒŒì¼ì„ ìˆ˜ì •í•©ë‹ˆë‹¤:

| ì œì•ˆ ìœ í˜• | ìˆ˜ì • íŒŒì¼ | ìˆ˜ì • ëŒ€ìƒ |
|-----------|----------|----------|
| `code_pattern` | `src/rag/infrastructure/query_analyzer.py` | `INTENT_PATTERNS` ë”•ì…”ë„ˆë¦¬ |
| `code_weight` | `src/rag/infrastructure/query_analyzer.py` | `WEIGHT_PRESETS` ë”•ì…”ë„ˆë¦¬ |
| `code_audience` | `src/rag/infrastructure/query_analyzer.py` | `*_KEYWORDS` ìƒìˆ˜ |

**ìˆ˜ì • ì‹œ ì£¼ì˜ì‚¬í•­**:
1. ê¸°ì¡´ íŒ¨í„´/í‚¤ì›Œë“œë¥¼ ì‚­ì œí•˜ì§€ ì•ŠìŒ
2. ìƒˆ í•­ëª©ë§Œ ì¶”ê°€
3. íŒ¨í„´ ì¶©ëŒ ì—¬ë¶€ ê²€í† 

### 3.3 íŒ¨ì¹˜ ê²€ì¦

// turbo
```bash
uv run pytest tests/rag/test_query_analyzer.py -v --tb=short
```

í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ ìˆ˜ì •ì‚¬í•­ì„ ë˜ëŒë¦¬ê³  ë‹¤ì‹œ ê²€í† í•©ë‹ˆë‹¤.

---

## Phase 4: ì¬í‰ê°€

### 4.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í™•ì¸

// turbo
```bash
uv run pytest tests/rag/ -v --tb=short
```

ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•´ì•¼ í•©ë‹ˆë‹¤.

### 4.2 í‰ê°€ ì¬ì‹¤í–‰

// turbo
```bash
uv run python scripts/auto_evaluate.py --run
```

### 4.3 ê²°ê³¼ ë¹„êµ

ì´ì „ ê²°ê³¼ì™€ ë¹„êµí•˜ì—¬:
- **í†µê³¼ìœ¨ ì¦ê°€**: ê°œì„  ì„±ê³µ
- **í†µê³¼ìœ¨ ë™ì¼**: ê°œì„  íš¨ê³¼ ì—†ìŒ (ë‹¤ë¥¸ ì ‘ê·¼ í•„ìš”)
- **í†µê³¼ìœ¨ ê°ì†Œ**: íšŒê·€ ë°œìƒ (ìˆ˜ì • ë˜ëŒë¦¬ê¸°)

---

## Phase 5: ë°˜ë³µ íŒë‹¨

### 5.1 ì¢…ë£Œ ì¡°ê±´ í™•ì¸

ë‹¤ìŒ ì¤‘ í•˜ë‚˜ì— í•´ë‹¹í•˜ë©´ **Phase 6ìœ¼ë¡œ ì´ë™**:

1. âœ… **ëª©í‘œ ë‹¬ì„±**: í†µê³¼ìœ¨ â‰¥ 85%
2. âš ï¸ **ê°œì„  í•œê³„**: 2íšŒ ì—°ì† ë™ì¼ ê²°ê³¼
3. â›” **ìµœëŒ€ ë°˜ë³µ**: 3íšŒ ì‚¬ì´í´ ì™„ë£Œ
4. ğŸ”§ **êµ¬ì¡°ì  ë¬¸ì œ**: `architecture` ìœ í˜• ì œì•ˆë§Œ ë‚¨ìŒ

### 5.2 ë°˜ë³µ ì‹¤í–‰

ì¢…ë£Œ ì¡°ê±´ì— í•´ë‹¹í•˜ì§€ ì•Šìœ¼ë©´ **Phase 2ë¡œ ëŒì•„ê°€ì„œ** ë°˜ë³µí•©ë‹ˆë‹¤.

```
ë°˜ë³µ ì¹´ìš´í„°: í˜„ì¬ NíšŒ / ìµœëŒ€ 3íšŒ
```

---

## Phase 6: ì™„ë£Œ ë³´ê³ 

### 6.1 ì„¸ì…˜ ìš”ì•½ ìƒì„±

ë‹¤ìŒ ì •ë³´ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤:

1. **ì‹œì‘ ìƒíƒœ**: ì´ˆê¸° í†µê³¼ìœ¨, ì‹¤íŒ¨ ì¼€ì´ìŠ¤ ìˆ˜
2. **ì ìš©ëœ ê°œì„ **:
   - ì¶”ê°€ëœ ì¸í…íŠ¸ íŠ¸ë¦¬ê±°
   - ì¶”ê°€ëœ ë™ì˜ì–´
   - ìˆ˜ì •ëœ ì½”ë“œ (íŒŒì¼, ë¼ì¸, ë³€ê²½ ë‚´ìš©)
3. **ìµœì¢… ìƒíƒœ**: ìµœì¢… í†µê³¼ìœ¨, ë‚¨ì€ ì‹¤íŒ¨ ì¼€ì´ìŠ¤
4. **ë‚¨ì€ ë¬¸ì œ**: í•´ê²°ë˜ì§€ ì•Šì€ ì œì•ˆ ìœ í˜•
5. **ë‹¤ìŒ ë‹¨ê³„ ê¶Œì¥ì‚¬í•­**

### 6.2 ë³´ê³ ì„œ ì €ì¥

ìš”ì•½ ë³´ê³ ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

```bash
# ìµœì¢… ìƒíƒœ ì¶œë ¥
uv run python scripts/auto_evaluate.py --run
```

---

## í”Œë«í¼ ì¼ê´€ì„± ê²€ì¦ (ì„ íƒì )

CLIì™€ Web UIì˜ ê²°ê³¼ ì¼ê´€ì„±ì„ í™•ì¸í•©ë‹ˆë‹¤.

### í…ŒìŠ¤íŠ¸ ë°©ë²•

1. **í…ŒìŠ¤íŠ¸ ì¿¼ë¦¬ ì„ ì •**: ì‹¤íŒ¨í–ˆë˜ ì¿¼ë¦¬ ì¤‘ 3-5ê°œ ì„ íƒ
2. **CLI ì‹¤í–‰**:
   // turbo
   ```bash
   uv run regulation search "í…ŒìŠ¤íŠ¸ ì¿¼ë¦¬" -a -v
   ```
3. **Web UI ì‹¤í–‰**:
   ```bash
   uv run regulation serve --web
   ```
4. **ë¹„êµ í•­ëª©**:
   - ê²€ìƒ‰ëœ ê·œì • ì¡°í•­ ë™ì¼ ì—¬ë¶€
   - LLM ë‹µë³€ í’ˆì§ˆ ìœ ì‚¬ì„±
   - ë©”íƒ€ë°ì´í„° ì¼ê´€ì„±

---

## ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Phase 0: ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ ì™„ë£Œ
- [ ] Phase 1: ì´ˆê¸° í‰ê°€ ì™„ë£Œ
- [ ] Phase 2: ì‹¤íŒ¨ ë¶„ì„ ì™„ë£Œ
- [ ] Phase 3: ê°œì„  ì ìš© ì™„ë£Œ
- [ ] Phase 4: ì¬í‰ê°€ ì™„ë£Œ
- [ ] Phase 5: ì¢…ë£Œ ì¡°ê±´ í™•ì¸
- [ ] Phase 6: ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### í‰ê°€ ìŠ¤í¬ë¦½íŠ¸ ì‹¤íŒ¨
```bash
# LLM ì—°ê²° í™•ì¸
curl http://localhost:11434/api/tags 2>/dev/null || echo "Ollama ë¯¸ì‹¤í–‰"
```

### í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ
```bash
# íŠ¹ì • í…ŒìŠ¤íŠ¸ ë””ë²„ê¹…
uv run pytest tests/rag/test_query_analyzer.py::test_specific -v -s
```

### íŒ¨ì¹˜ ì ìš© í›„ ë¬¸ì œ ë°œìƒ
```bash
# Gitìœ¼ë¡œ ë³€ê²½ì‚¬í•­ í™•ì¸
git diff data/config/
git diff src/rag/infrastructure/query_analyzer.py

# í•„ìš”ì‹œ ë˜ëŒë¦¬ê¸°
git checkout -- data/config/intents.json
```

---

*ì´ ì›Œí¬í”Œë¡œìš°ëŠ” `/comprehensive_rag_testing` ëª…ë ¹ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.*
