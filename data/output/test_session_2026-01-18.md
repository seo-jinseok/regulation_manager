# RAG 시스템 품질 테스트 세션 보고서

**테스트 일시**: 2026-01-18
**테스터**: AI Agent (엄격 모드)
**시스템 버전**: regulation_manager (동의대학교 규정)

---

## 1. 시작 상태

### 1.1 시스템 상태
- 마지막 동기화: 2026-01-16T05:09:28
- 규정 수: 318개
- 조항 수: 17,254개

### 1.2 LLM 설정
- Provider: lmstudio
- Model: exaone-4.0-32b-mlx
- Base URL: http://game-mac-studio:1234

### 1.3 RAG 설정 (기본값 적용)
- ENABLE_SELF_RAG: true
- ENABLE_HYDE: true
- BM25_TOKENIZE_MODE: konlpy

---

## 2. Phase 1: 정적 평가 결과

| 항목 | 결과 | 목표 | 상태 |
|------|------|------|------|
| 총 테스트 케이스 | 50 | - | - |
| 통과 | 45 | - | - |
| 실패 | 5 | - | - |
| **통과율** | **90.0%** | ≥85% | ✅ 달성 |
| 의도 인식 정확도 | 94.0% | - | ✅ |
| 키워드 커버리지 | 99.3% | - | ✅ |
| 규정 코드 정확도 | 94.0% | - | ✅ |

### 정적 평가 실패 케이스
1. 연구 부정행위 신고하고 싶어
2. 취업 준비로 졸업 미루고 싶어
3. 징계 절차가 어떻게 돼?
4. 학생 창업 지원받을 수 있어?
5. 취업 지원 프로그램이 있어?

---

## 3. Phase 1.5: RAG 컴포넌트 단위 테스트

| 컴포넌트 | 상태 | 검증 내용 |
|----------|------|----------|
| Self-RAG | ✅ | 인사말 스킵, 정보 쿼리 검색 정상 |
| HyDE | ✅ | 모호 쿼리("학교 가기 싫어")에서 휴직/휴학 검색 |
| Hybrid Search | ✅ | BM25+Dense 융합 정상 |
| Reranker | ✅ | ON/OFF 비교 - 관련 결과 상위 배치 |
| Query Analyzer | ✅ | 인텐트 매칭 및 키워드 확장 정상 |
| 입력 검증 | ⚠️ | XSS 차단 ✅, Template Injection 미차단 |

---

## 4. Phase 2: 동적 쿼리 테스트 결과

### 4.1 테스트 페르소나
- 🎓 신입생
- 📚 재학생 (3학년)
- 🤕 어려운 상황의 학생
- 👨‍🏫 신임 교수

### 4.2 쿼리별 결과

| 페르소나 | 쿼리 | 난이도 | 의도추론 | 점수 | 판정 |
|----------|------|--------|----------|------|------|
| 신입생 | 수강신청 언제야? | 쉬움 | 90% | 4.4 | ✅ |
| 신입생 | 장학금 성적 기준 | 중간 | 60% | 3.3 | ❌ |
| 신입생 | 기숙사 입사 방법 | 어려움 | 95% | 4.7 | ✅ |
| 재학생 | 졸업학점 | 쉬움 | 70% | 3.7 | ❌ |
| 재학생 | 복수전공 신청 | 중간 | 95% | 4.7 | ✅ |
| 재학생 | 졸업 영어 요건 | 어려움 | 85% | 3.7 | ❌ |
| 어려운상황 | 학사경고 결과 | 쉬움 | 80% | 4.0 | ✅ |
| 어려운상황 | 성적 이의신청 | 중간 | 95% | 4.7 | ✅ |
| 어려운상황 | 등록금 납부 어려움 | 어려움 | 90% | 4.3 | ✅ |
| 신임교수 | 연구년 자격 | 쉬움 | 100% | 4.8 | ✅ |
| 신임교수 | 교수 승진 기준 | 중간 | 60% | 3.1 | ❌ |
| 신임교수 | 겸직 허가 | 어려움 | 95% | 4.7 | ✅ |

### 4.3 동적 쿼리 통계

| 메트릭 | 결과 | 목표 | 상태 |
|--------|------|------|------|
| 성공 | 8개 | - | - |
| 실패 | 4개 | - | - |
| **성공률** | **66.7%** | ≥80% | ❌ 미달 |
| 의도 추론 정확도 | 84.6% | ≥85% | ⚠️ 근접 |
| 평균 점수 | 4.1/5.0 | ≥4.0 | ✅ 달성 |

---

## 5. Phase 4: 멀티턴 대화 테스트

### 5.1 시나리오: 신입생 - 휴학 문의 (5턴)

| Turn | 쿼리 | 맥락유지 | 의도추론 | 판정 |
|------|------|---------|---------|------|
| 1 | 휴학하고 싶어요 | ✅ | 100% | ✅ |
| 2 | 일반휴학 신청 기간 | ✅ | 70% | ⚠️ |
| 3 | 장학금 어떻게 돼요? | ✅ | 60% | ⚠️ |
| 4 | 복학할 때는요? | ✅ | 90% | ✅ |
| 5 | 휴학 기간 최대 | ✅ | 90% | ✅ |

### 5.2 멀티턴 종합 점수

| 항목 | 점수 |
|------|------|
| 맥락 유지 | 5/5 (1.0) |
| 정보 일관성 | 4/5 (0.8) |
| 점진적 심화 | 3/5 (0.6) |
| 중복 회피 | 5/5 (0.5) |
| 자연스러운 전환 | 4/5 (0.4) |
| 후속 질문 예측 | 4/5 (0.4) |
| 의도 추론 정확도 | 82% (0.4) |
| **총점** | **4.1/5.0** |

**멀티턴 판정**: ✅ 성공

---

## 6. 실패 케이스 분석

### 6.1 장학금 성적 기준
- **실패 유형**: INCOMPLETE
- **근본 원인**: 장학금 종류별 성적 기준이 개별 세칙에 분산
- **개선 제안**: intents.json에 "장학금_성적_기준" 인텐트 추가

### 6.2 졸업학점
- **실패 유형**: INCOMPLETE (첫 시도 실패)
- **근본 원인**: 검색 로직 반복 문제
- **개선 제안**: 단순 쿼리 처리 로직 개선

### 6.3 졸업 영어 요건
- **실패 유형**: INCOMPLETE
- **근본 원인**: 졸업 요건 전체 목록 검색 안 됨
- **개선 제안**: 졸업 요건 통합 인텐트 추가

### 6.4 교수 승진 기준
- **실패 유형**: INCOMPLETE
- **근본 원인**: 승진 누락(부정적)과 승진 요건(긍정적) 구분 미흡
- **개선 제안**: "승진_요건" 인텐트 추가

---

## 7. 최종 결과 요약

| 메트릭 | 결과 | 목표 | 상태 |
|--------|------|------|------|
| 정적 테스트 통과율 | 90점 | ≥85점 | ✅ |
| 동적 쿼리 성공률 | 67점 | ≥80점 | ❌ |
| 멀티턴 성공률 | 100점 | ≥80점 | ✅ |
| 답변 품질 점수 | 82점 | ≥80점 | ✅ |
| 의도 추론 정확도 | 85점 | ≥85점 | ⚠️ |
| 회귀 발생 | 0건 | 0건 | ✅ |

---

## 8. 다음 단계 권장사항

### 8.1 우선순위 높음
1. **intents.json 개선**
   - 장학금_성적_기준 인텐트 추가
   - 졸업_요건 통합 인텐트 추가
   - 승진_요건 인텐트 추가 (긍정적 맥락)

2. **검색 로직 개선**
   - 단순 쿼리 처리 시 반복 오류 수정
   - 복합 인텐트 매칭 로직 개선

### 8.2 우선순위 중간
3. **입력 검증 강화**
   - Template Injection 패턴 (`{{}}`) 차단 추가

4. **synonyms.json 확장**
   - "있어?" → 지원, 프로그램, 제도 등 동의어 추가

### 8.3 우선순위 낮음
5. **RAG 컴포넌트 튜닝**
   - HyDE 발동 조건 조정 (복합 쿼리 포함)
   - Corrective RAG 임계값 미세 조정

---

## 9. 세션 종료

**테스트 완료 시각**: 2026-01-18
**다음 테스트 권장**: intents.json 개선 후 재평가
